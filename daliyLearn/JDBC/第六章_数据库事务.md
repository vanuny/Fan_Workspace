## 第六章_数据库事务

8.40 --> 10.48  --> 11.44 = 3h


### 数据库事务介绍

> 一组逻辑操作单元,使数据从一种状态转变到另一种状态.
>**事务处理(事务操作)**:保证所有事务都作为一个工作单元来执行,即使出现了故障,都不能改变这种执行方式,当在一个事务中执行多个操作时,要么所有的事务都被提交,那么这些修改就永久地保存下来.要么数据库管理系统放弃所做的操作,整个事务**回滚**到最初状态

数据一旦提交,就不可回滚

4. 哪些操作会导致数据的提交?
    - DDL操作一旦操作,都会自动提交
        * set autocommit = false对DDL操作失效
    - DML默认情况下,一旦执行,就会自动提交
        * 可以通过set autocommit = false的方式取消DML操作的自动提交
    * 默认在关闭连接时,会自动提交数据



### 事务的ACID属性

1. 原子性:
    * 指事务是一个不可分割的工作单位,事务中的操作要都发生,要么都不发生.

2. 一致性:
    * 事务必须使数据库从一个一致性状态到另一个一致性状态.

3. 隔离性:
    * 指一个事务的执行不能被其他事务干扰.(类似 线程安全问题)

4. 持久性 
    * 一个事务一旦提交,它对数据库的改变就是永久性的,接下来的其他操作和数据库故障不应该对其有任何影响

#### 数据库的并发问题

脏读:

不可重复读:(可接受)

幻读:(可接受)



隔离级别越高,数据一致性就越好,但并发性就越弱

#### 四种隔离级别

|隔离界别|描述|
|-|-|
|未读提交数据|一般不选|
|读已提交数据||
|可重复读||
|串行化|性能十分低下|

Oralce 默认Read Commit

MySql 默认 Repeatable read